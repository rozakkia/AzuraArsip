extends ../layout

block css
    link(rel="stylesheet", href="assets/js/plugins/select2/css/select2.min.css")
    link(rel="stylesheet", href="assets/js/plugins/datatables/dataTables.bootstrap4.css")

block content
    .content.content-full
        .py-50
            .position-relative
                span.text-back #{title}
                .row
                    .col-6
                        nav.breadcrumb.push
                            a.breadcrumb-item(href='/') Dashboard
                            span.breadcrumb-item.active #{title}
                h4.font-w300.mt-50 #{title} 
                    small Overview
                .row
                    .col-8
                        .block.block-rounded
                            .block-content.block-content-full
                                i.si.si-game-controller.fa-2x.text-body-bg-dark 
                                span.h5.text-body-bg-dark October 2020
                                .row.py-20.text-center
                                    .col-6.border-r
                                        .font-size-h3.font-w600 24
                                        .font-size-sm.font-w600.text-uppercase.text-muted Invoices
                                    .col-6
                                        .font-size-h3.font-w600 24
                                        .font-size-sm.font-w600.text-uppercase.text-muted Receipts
                    .col-4
                        a.block.block-rounded.block-bordered.block-link-pop.text-center(href="/clients" target="_blank")
                            .block-content
                                p.font-size-h1.mb-0.mt-30
                                    i.si.si-globe.text-primary 
                                p.font-w600.mb-30.mt-5.text-primary Clients
                .block.mt-50
                    .block-header.block-header-default
                        h3.block-title(id="invoices") Billings
                        .block-options
                            button.btn-block-option.mr-20(data-toggle="block-option" data-action="fullscreen_toggle")
                            a.btn.btn-primary.btn-noborder.btn-hero(data-toggle="modal" data-target="#mdl_billing-tambah" href="javascript:void(0)") Tambah Billings
                    .block-content.block-content-full
                        table.table.table-bordered.table-striped.table-vcenter.js-dataTable-full
                            thead
                                tr
                                    th.text-center No
                                    th Invoice Number
                                    th.d-none.d-sm-table-cell Keterangan
                                    th.d-none.d-sm-table-cell Client Company
                                    th.d-none.d-sm-table-cell Jenis
                                    th.d-none.d-sm-table-cell Status
                                    th.text-center Action
                            tbody
                                if resultGetBills
                                    - i = 1
                                    for bill_data in resultGetBills
                                        tr
                                            td.text-center #{i}
                                            td.font-w600.w-5 #{bill_data.no_bill}
                                            td.d-none.d-sm-table-cell 
                                                if bill_data.keterangan == null
                                                    em.text-muted Belum tersedia
                                                else 
                                                    | #{bill_data.keterangan}
                                            td.d-none.d-sm-table-cell #{bill_data.Client.company_name}
                                            td.d-none.d-sm-table-cell 
                                                case bill_data.jenis
                                                    when 1
                                                        span.badge.badge-primary Invoice
                                                    when 2 
                                                        span.badge.badge-info Receipt
                                                    default
                                                        span.badge.badge-danger Galat Error!
                                            td.d-none.d-sm-table-cell 
                                                case bill_data.status
                                                    when 0
                                                        span.badge.badge-danger Incompleted
                                                    when 1 
                                                        span.badge.badge-info Completed
                                            td.text-center
                                                a.btn.btn-sm.btn-noborder.btn-alt-secondary.mr-5(href="/billings/detail?passCode=" + Buffer.from(bill_data.no_bill).toString('base64') ) Detail
                                        - i = i+1

block modal
    .modal.fade(id="mdl_billing-tambah" tabindex="-1" role="dialog")
        .modal-dialog.modal-sm.modal-dialog-centerd.modal-dialog-popout(role="document")
            .modal-content.rounded
                .block.block-rounded.block-transparent
                    .block-content.py-50.px-30
                        h4.font-w700.text-center.mb-0.mt-lg-30 Tambah Billing 
                        p.text-muted.text-center.font-w400 Lengkapi isian berikut
                        form.js-validation-(action="/billings" method="POST")
                            input(type="text" name="userid" value=user.id hidden)
                            .form-group.mt-20
                                select.js-select2.form-control(style="width:100%" id="example-select2" name="idclient" data-placeholder="Company Client")
                                    option
                                        for client_data in resultClients
                                            option(value=client_data.id) #{client_data.company_name}
                            .form-group.mt-20
                                select.js-select2.form-control(style="width:100%" id="select-type" name="typebill" data-placeholder="Billing Types")
                                    option
                                        option(value="1") Invoice
                                        option(value="2") Receipt
                            button.btn.btn-primary.btn-noborder.btn-hero.w-100.mt-20(type="submit") Buat Billing

block helpers
    script(src="assets/js/plugins/select2/js/select2.full.min.js")
    script(src="assets/js/plugins/datatables/jquery.dataTables.min.js")
    script(src="assets/js/plugins/datatables/dataTables.bootstrap4.min.js")

    script(src="assets/js/pages/be_tables_datatables.min.js")
    script.
        jQuery(function(){ Codebase.helpers(['select2']); })

